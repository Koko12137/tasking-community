# Bash 文本编辑工具

# 1. 工具简介
以下工具均适用于 Linux/macOS 的 Bash 终端，核心解决“文本文件创建、非交互式编辑、带行号查看”需求，全程无需依赖快捷键或交互界面，仅通过命令行指令完成操作：
- **`sed`**：非交互式流编辑器，通过单行命令直接实现文本替换、指定行修改，无交互界面，适合批量处理或脚本化操作；
- **`touch`**：辅助工具，仅通过基础命令快速创建空文本文件，为后续非交互式编辑提供基础文件；
- **`cat`**：轻量查看工具，支持显示行号，适合快速查看小文件内容；
- **`less`**：分页查看工具，支持显示行号，适合大文件（如日志、长配置）的内容浏览；
- **`nl`**：专用行号标注工具，可自定义空行是否显示行号，适合对有效内容标行的场景。


# 2. 工具可用命令
| 工具   | 核心命令格式                                                                 | 功能说明                                                                 |
|--------|------------------------------------------------------------------------------|--------------------------------------------------------------------------|
| `sed`  | `sed 's/旧内容/新内容/[选项]' 文件名`（预览修改，不改变原文件）<br>`sed -i 's/旧内容/新内容/[选项]' 文件名`（直接修改原文件）<br>`sed -i.bak 's/旧内容/新内容/' 文件名`（修改并备份原文件） | 非交互式文本替换：`g`=全局替换，`5,10s/...`=指定第5-10行替换，`-i.bak`=生成`.bak`后缀备份文件 |
| `touch`| `touch [文件名1] [文件名2]...`                                               | 快速创建1个或多个空文本文件（如 `touch log.txt config.ini` 同时创建2个空文件） |
| `cat`  | `cat -n 文件名`                                                              | 查看文件内容并显示行号（含空行），适合小文件快速浏览                     |
| `less` | `less -N 文件名`                                                             | 分页查看文件内容并显示行号，支持上下滚动（Enter=翻1行，Space=翻1页），适合大文件 |
| `nl`   | `nl 文件名`（默认空行不显示行号）<br>`nl -b a 文件名`（空行也显示行号）       | 查看文件并标注行号，可通过 `-b a` 控制空行是否标行，适合区分有效内容与空行 |


# 3. 工具命令示范
## （1）`touch` + `sed`：创建并非交互式编辑文件
```bash
# 步骤1：用 touch 创建空文件（非交互式，仅命令）
touch app.conf

# 步骤2：用 sed 非交互式写入基础配置（无需打开文件，直接通过命令注入内容）
# 向文件末尾追加2行配置（echo 生成内容，>> 追加到文件）
echo -e "[server]\nport=8080\nhost=localhost" >> app.conf

# 步骤3：用 sed 非交互式修改配置（将 port=8080 改为 port=8000，预览效果）
sed 's/port=8080/port=8000/' app.conf

# 步骤4：确认预览正确后，用 sed 直接修改原文件（并备份原文件为 app.conf.bak）
sed -i.bak 's/port=8080/port=8000/' app.conf

# 步骤5：验证修改结果（用 cat 查看最终内容）
cat app.conf
```

## （2）`sed`：批量/指定行修改文件
```bash
# 示例1：全局替换日志文件中的关键词（预览效果）
# 查看 log.txt 中所有“error”替换为“ERROR”的结果，不改变原文件
sed 's/error/ERROR/g' log.txt

# 示例2：指定行修改配置文件（直接生效）
# 修改 config.ini 第3-5行的“debug=false”为“debug=true”
sed -i '3,5s/debug=false/debug=true/' config.ini

# 示例3：脚本中批量修改多文件（递归处理所有 .sh 脚本）
# 递归查找当前目录下所有 .sh 文件，将“bash”替换为“/bin/bash”（避免路径问题）
find . -name "*.sh" -exec sed -i 's/bash/\/bin\/bash/' {} \;
```

## （3）查看带行号的文件内容
```bash
# 示例1：用 cat -n 查看小文件（显示行号，含空行）
# 查看 app.conf 内容，每行前标注行号
cat -n app.conf
# 输出效果（示例）：
     1  [server]
     2  port=8000
     3  
     4  host=localhost

# 示例2：用 less -N 查看大文件（分页+行号）
# 查看 100MB 的 access.log 日志，分页显示并标注行号
less -N access.log
# 操作说明：按 Enter 向下翻1行，按 Space 向下翻1页，按 q 退出查看

# 示例3：用 nl 查看文件（控制空行是否标行）
# 1. 默认模式（空行不显示行号）：查看 script.sh，仅有效内容标行
nl script.sh
# 输出效果（示例）：
     1  #!/bin/bash
     2  echo "当前时间：$(date)"
        （空行，无行号）
     3  echo "脚本执行完成"

# 2. 空行也显示行号（加 -b a 选项）：查看 script.sh，空行也标注行号
nl -b a script.sh
```


# 4. 注意事项
1. **`sed` 安全操作**：
   - 直接修改原文件（`-i` 选项）前，务必先用无 `-i` 的命令预览效果（如 `sed 's/.../.../' 文件名`），确认修改逻辑正确；
   - 重要文件（如系统配置）修改时，建议用 `-i.bak` 生成备份（如 `sed -i.bak '...' /etc/profile`），避免误改后无法恢复。

2. **`touch` 批量创建**：
   - 同时创建多个文件时，文件名之间用空格分隔（如 `touch a.txt b.log c.conf`），避免因缺少空格导致文件名错误（如 `touch a.txtb.log` 会生成1个名为“a.txtb.log”的文件）；
   - 创建后可通过 `ls` 命令验证文件是否成功创建（如 `ls a.txt b.log`）。

3. **查看工具选择**：
   - 小文件（<100行）优先用 `cat -n`，操作简洁；大文件（>1000行）优先用 `less -N`，避免一次性加载卡顿；
   - `nl` 适合需要区分“有效内容行”与“空行”的场景（如代码文件），默认不标空行行号，可通过 `-b a` 调整。

4. **特殊字符处理**：
   - `sed` 替换含 `/` 的内容时（如路径 `/home/user`），需将分隔符替换为 `#` 或 `@`（如 `sed 's#/home/user#/root#' 文件名`），避免与内容中的 `/` 冲突；
   - `echo` 注入多行内容时，用 `-e` 支持换行符 `\n`（如 `echo -e "line1\nline2" >> 文件名`），否则 `\n` 会被当作普通字符显示。
