# 事件型记忆压缩提取提示词
## 一、场景与核心目标
### 1. 适用场景
用于将事件全量信息（含当前状态、执行动作、交互过程、结果反馈）压缩为**精简且关键信息无遗漏**的事件总结，支撑记忆库归档、任务回溯、跨场景复用等需求，尤其适用于“事件信息冗余（含系统提示、重复表述）但关键细节需留存”的场景。

### 2. 核心目标
实现“去繁存精”：在大幅压缩冗余信息的同时，**100%保留事件核心逻辑与关键细节**，确保压缩后的总结可直接用于事件回溯、状态衔接，且无信息偏差。


## 二、关键信息界定（核心规则）
### （一）必须完整保留的信息（不可删减、不可简化关键细节）
1. **工具调用相关信息**（全维度留存）
   - 基础标识：工具名称、工具调用唯一ID（若有）、调用触发条件；
   - 核心参数：调用时的关键输入参数（如检索关键词、执行指令、配置项）；
   - 结果数据：工具返回的原始核心结果（如检索结果片段、生成内容摘要、错误提示）、结果状态（成功/失败/部分成功）；
   - 时间关联：工具调用时间、结果返回时间（精确到分钟级，若有时间戳需保留）。

2. **人类用户介入反馈**（全场景留存）
   - 交互内容：用户原始指令、实时反馈（认可/质疑/调整需求）、补充说明、决策结论；
   - 交互属性：用户介入时间、交互场景（如卡点反馈、结果确认、需求变更）；
   - 影响关联：用户反馈对事件的影响（如调整执行路径、暂停任务、补充资源）。

3. **事件核心要素**（逻辑链留存）
   - 标识信息：事件唯一ID/名称、所属领域/任务类型；
   - 执行状态：当前所处阶段（启动/执行中/暂停/完成）、核心动作（如“检索历史任务”“调用分析工具”“同步用户反馈”）；
   - 结果与卡点：最终结果（成功/失败/待推进）、卡点原因（如“工具返回无匹配结果”“用户需补充需求细节”）、未完成事项及优先级；
   - 关联关系：与上游/下游事件的关联（如“承接任务A的后续压缩”“为任务B提供历史数据”）。

### （二）可最大化压缩的信息（允许精简、合并，不影响核心逻辑即可）
1. **系统内置提示词**：如通用引导语（“请按要求执行任务”）、格式说明（“输出需包含XX字段”）、重复流程提示（“先检索再分析”），仅需保留“核心意图”（如“系统引导执行检索+分析流程”），无需保留完整原文。
2. **冗余表述**：同一信息的多次强调（如“需保留工具结果”重复出现3次，仅保留1次）、无关备注（如“临时草稿备注”“待确认但未影响执行的疑问”）。
3. **通用流程信息**：非事件专属的通用步骤（如“打开工具→输入参数→点击执行”这类通用操作，若工具调用信息已留存，可省略该流程描述）。


## 三、压缩提取执行步骤
1. **第一步：信息筛选（区分关键/非关键）**
   - 通读事件全量信息，按“二、关键信息界定”标准，用“标记法”拆分：关键信息标“★”，可压缩信息标“△”，确保无遗漏关键项。

2. **第二步：关键信息梳理（建立逻辑链）**
   - 按“时间线”或“事件逻辑”（触发→执行→交互→结果）整理“★”类信息，确保：
     - 工具调用、用户反馈、结果状态的因果关系清晰（如“用户反馈‘需补充检索维度’→调用XX工具补充参数→返回3条匹配结果”）；
     - 未完成事项与卡点的关联明确（如“卡点：工具无结果→未完成事项：需调整检索关键词→原因：用户原关键词范围过窄”）。

3. **第三步：冗余信息压缩（去繁）**
   - 对“△”类信息：系统提示词仅提炼核心意图（如完整提示“请先检索历史任务，再按格式输出结果，确保保留工具返回内容”→压缩为“系统引导检索+按格式输出，需保留工具结果”）；
   - 重复表述合并（如多次提及“用户要求优先处理卡点”→合并为“用户明确要求优先处理卡点”）；
   - 通用流程直接省略（如“打开VS Code→找到文件→读取内容”，若“读取文件内容”已作为“关键动作”留存，可省略前两步）。

4. **第四步：逻辑校验与语言精简**
   - 校验：确认关键信息无缺失、因果/时间逻辑无断裂（如“工具调用时间”需与“用户反馈时间”的先后顺序正确）；
   - 精简：用简洁语言重组内容，避免冗余词汇（如“在2024年10月20日14:30的时候，调用了XX检索工具，输入的检索关键词是‘未完成任务历史’，工具返回了5条相关结果”→优化为“2024-10-20 14:30调用XX检索工具，关键词‘未完成任务历史’，返回5条结果”）。


## 四、输出格式规范
| 模块          | 内容要求                                                                 |
|---------------|--------------------------------------------------------------------------|
| 1. 事件标识   | 含事件ID/名称、所属领域、记录时间（压缩提取完成时间）                     |
| 2. 核心总结   | 100-300字，串联“触发条件→关键动作（含工具调用）→用户交互→结果/卡点”逻辑 |
| 3. 关键明细   | 分“工具调用”“用户介入”“未完成事项”3个子项，逐条列关键信息（不冗余）     |
| 4. 压缩说明   | 简要说明本次压缩的冗余内容类型（如“压缩系统提示词2段、合并重复反馈1处”） |


## 五、质量校验标准
1. 关键信息完整性：工具调用参数/结果、用户反馈内容、事件结果/卡点无缺失；
2. 逻辑连贯性：时间线、因果关系无混乱（如“用户反馈后调用工具”不可写为“调用工具后用户反馈”）；
3. 冗余压缩度：可压缩信息（系统提示、重复表述）占比≤10%（原信息总量对比）；
4. 表述简洁性：无冗余词汇，单条关键明细不超过2行（每行≤30字）。


## 示例（参考）
### 原始信息片段（含冗余）
【系统提示】请你先读取当前任务的执行记录，再调用检索工具查找类似任务，过程中需保留工具返回结果，若有用户反馈需同步记录……【执行动作】2024-10-20 14:30，调用“历史任务检索工具”，输入关键词“未完成任务执行历史+类似任务经验”，参数“时间范围：近3个月，领域：任务管理”，工具返回3条结果（结果1：任务A执行历史（2024-08），含卡点解决方案；结果2：任务B类似经验（2024-09），无匹配；结果3：任务C执行路径（2024-10），可复用）。【用户反馈】2024-10-20 15:00，用户说“结果1的卡点方案需重点保留，结果2可忽略，补充检索‘任务资源配置经验’”。【系统提示】后续需按用户新要求调整检索关键词，确保结果准确……

### 压缩后输出
1. 事件标识：事件ID-T2024102001，领域-任务管理，提取时间-2024-10-20 15:10  
2. 核心总结：2024-10-20 14:30调用“历史任务检索工具”获取3条结果，15:00用户要求重点保留结果1、忽略结果2，并补充检索“任务资源配置经验”，当前待执行补充检索。  
3. 关键明细：  
   - 工具调用：2024-10-20 14:30，“历史任务检索工具”，关键词“未完成任务执行历史+类似任务经验”，参数“近3个月/任务管理”，返回3条（结果1：任务A卡点方案；结果2：无匹配；结果3：任务C路径）；  
   - 用户介入：2024-10-20 15:00，要求保留结果1、忽略结果2，补充检索“任务资源配置经验”；  
   - 未完成事项：补充检索“任务资源配置经验”（用户新增需求）；  
4. 压缩说明：压缩系统提示词2段（提炼为“系统引导执行检索+按用户要求调整”），无重复表述合并。