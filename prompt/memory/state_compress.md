# 任务状态提取与维护指南提示词
## 一、场景与核心目标
### 1. 适用场景
针对**任务全生命周期的状态管理**，覆盖两大核心场景：
- 场景1：任务初始启动（无历史状态）——从第一轮执行信息中提取基础状态，搭建初始状态框架，为后续执行提供“基准锚点”；
- 场景2：任务持续执行（已有历史状态）——基于本轮执行结果（如动作完成、用户反馈、工具结果）更新状态，确保状态与任务进度实时同步，支撑下一轮执行的“衔接连贯性”。

### 2. 核心目标
实现任务状态的“**精准锚定+动态同步**”：
- 初始提取：100%捕捉第一轮执行的核心状态要素，无关键信息遗漏，确保初始框架完整；
- 后续更新：仅保留状态变化项、删除无效旧状态、补充新增状态，确保更新后状态能直接指导下一轮执行，无逻辑偏差或信息滞后。


## 二、关键状态信息界定（核心规则）
### （一）必须完整保留/提取的核心状态要素（不可删减、不可简化）
#### 1. 任务基础标识（静态信息，初始提取后仅在必要时更新）
- 基础属性：任务唯一ID（与事件型记忆的“事件ID”关联）、任务名称、所属领域（如“任务管理”“数据检索”）、启动时间（精确到分钟）；
- 目标锚点：任务核心目标（如“完成XX领域历史任务检索与总结”“生成XX报告并同步用户反馈”），初始提取后若用户调整目标需同步更新。

#### 2. 执行核心状态（动态信息，每轮执行后需校验/更新）
- 进度阶段：当前所处阶段（启动中/执行中/待反馈/待补充资源/暂停/接近完成/已完成）；
- 当前动作：本轮已完成的核心动作（如“调用XX检索工具”“同步用户反馈至系统”）、下一轮待执行动作（如“基于用户要求补充检索”“验证工具返回结果”）；
- 进度占比：若任务有明确拆解（如“3步完成报告”），需标注当前进度（如“完成第1步，进度33%”）；无明确拆解时，用“关键动作完成度”描述（如“已完成2次检索，待执行结果整理”）。

#### 3. 资源与依赖（动态信息，随执行更新）
- 已用资源：本轮调用的工具（名称+调用结果状态）、消耗的数据/素材（如“使用XX数据库检索结果”“引用用户提供的XX文档片段”）；
- 待补资源：下一轮执行需补充的资源（如“需用户提供XX参数”“需调用XX分析工具获取新数据”）；
- 关联依赖：与其他任务/事件的关联关系（如“依赖任务B的检索结果”“需等待用户确认XX反馈后再执行”）。

#### 4. 卡点与待办（动态信息，每轮执行后需清零/新增）
- 当前卡点：阻碍下一轮执行的问题（如“工具返回无匹配结果”“用户未回复补充需求”），需标注卡点原因及影响范围（如“卡点：检索关键词无效→影响：无法获取历史任务数据，需下一轮调整关键词”）；
- 待办清单：下一轮必须完成的事项（按优先级排序，如“高优先级：调整检索关键词；中优先级：同步卡点给用户；低优先级：整理已获取的工具结果”）。

#### 5. 用户交互关联（动态信息，随反馈更新）
- 最新反馈：用户本轮给出的指令、确认/质疑意见（如“用户要求重点保留结果1的卡点方案”“用户需24小时内收到进度同步”）；
- 反馈落地：用户反馈对状态的影响（如“用户要求补充检索→待办清单新增‘补充检索XX关键词’”“用户确认结果有效→进度阶段从‘待反馈’更新为‘执行中’”）。

### （二）可优化/删除的非核心状态信息
1. 通用流程描述：非任务专属的操作步骤（如“打开工具→输入参数”，若“调用XX工具”已作为“当前动作”留存，可省略该流程）；
2. 无效旧状态：已完成的动作（如“上一轮执行的‘初始检索’”）、已解决的卡点（如“已修复的‘关键词无效’问题”）、已失效的待办（如“已完成的‘同步用户反馈’”）；
3. 冗余表述：同一状态的重复强调（如多次提及“待补充检索”，仅保留1次并标注优先级）、与当前进度无关的备注（如“临时草稿中的待确认疑问”）。


## 三、状态提取与维护执行步骤
### （一）场景1：任务初始启动（无历史状态）——初始状态提取步骤
#### 第一步：信息筛选（从第一轮执行信息中抓核心）
- 通读第一轮执行的全量信息（含用户初始指令、工具调用记录、首轮动作结果），按“二、关键信息界定”标注：
  - 核心状态要素（基础标识、执行阶段、初始动作、目标锚点）标“★”；
  - 非核心信息（通用流程、冗余备注）标“△”。

#### 第二步：状态结构化梳理（搭建初始框架）
- 按“基础标识→执行核心状态→资源与依赖→卡点与待办→用户交互关联”的顺序，整合“★”类信息，确保：
  - 基础标识与任务目标明确（如“任务ID-T2024102101，目标：检索XX领域近3个月未完成任务”）；
  - 初始执行状态无模糊表述（如“进度阶段：启动中→当前动作：完成首轮XX工具检索→待办：分析检索结果”）；
  - 无遗漏首轮潜在卡点（如“首轮检索结果仅1条，潜在卡点：关键词范围过窄→待办：评估是否需调整关键词”）。

#### 第三步：初始校验（确保框架完整）
- 校验维度：
  1. 基础标识是否与后续事件型记忆的“事件ID”关联；
  2. 待办清单是否能直接指导下一轮执行（无“模糊待办”，如“处理结果”需细化为“分析首轮检索结果并标注有效项”）；
  3. 核心目标是否清晰，无歧义（如避免“完成检索”，需明确“完成XX领域近3个月未完成任务的检索”）。


### （二）场景2：任务持续执行（已有历史状态）——状态更新步骤
#### 第一步：状态对比（定位变化项）
- 调取上一轮留存的“历史状态”，对比本轮执行信息（工具结果、用户反馈、动作完成情况），标注三类变化：
  - 新增状态：本轮出现的新动作、新卡点、新待办（如“用户新增‘补充检索XX关键词’需求→新增待办”）；
  - 失效旧状态：本轮已完成的动作、已解决的卡点（如“上一轮待办‘调整关键词’已完成→删除该待办”）；
  - 变更状态：进度阶段、优先级等的调整（如“完成补充检索→进度阶段从‘待补充资源’更新为‘执行中’”）。

#### 第二步：状态整合（动态同步）
- 按“保留有效旧状态+添加新增状态+删除失效旧状态”的逻辑更新，重点关注：
  - 进度连贯性：确保状态变更有“因果支撑”（如“进度从‘执行中’→‘待反馈’”，需标注原因“已完成结果整理，等待用户确认”）；
  - 待办优先级：若本轮新增待办与旧待办冲突，按用户反馈或任务目标调整优先级（如“用户要求优先解决卡点→将‘处理卡点’优先级从‘中’提为‘高’”）；
  - 依赖同步：若关联任务的状态变化影响当前任务，需同步更新依赖信息（如“依赖的任务B已完成检索→删除‘等待任务B结果’的依赖项”）。

#### 第三步：更新校验（确保可指导下一轮）
- 校验维度：
  1. 无无效旧状态残留（如已完成的动作仍在“当前动作”中）；
  2. 新增卡点/待办有明确“解决路径提示”（如“卡点：工具无结果→标注‘需调整检索关键词或扩大时间范围’”）；
  3. 状态与下一轮执行目标匹配（如“下一轮目标是‘同步结果给用户’→状态中‘待办清单’需包含‘整理结果并生成反馈文档’”）。


## 四、输出格式规范
| 模块                | 内容要求                                                                 | 场景1（初始提取）特殊说明                          | 场景2（更新）特殊说明                              |
|---------------------|--------------------------------------------------------------------------|---------------------------------------------------|---------------------------------------------------|
| 1. 任务基础标识     | 任务ID（关联事件型记忆ID）、任务名称、领域、启动时间、核心目标             | 需完整填写所有项，确保“任务ID”与后续事件ID一致     | 仅更新“核心目标”（若用户调整），其余项保持不变     |
| 2. 当前核心状态     | 进度阶段、当前已完成动作、下一轮待执行动作、进度占比/完成度               | 进度阶段固定为“启动中”，进度占比按首轮动作估算    | 需标注“阶段变更原因”（如“阶段从待反馈→执行中，因用户已确认反馈”） |
| 3. 状态明细         | 分“资源与依赖”“卡点与待办”“用户交互关联”3个子项，逐条列关键信息（无冗余） | “资源与依赖”仅列首轮已用资源，“卡点”列潜在问题    | “资源与依赖”删除已失效资源，“卡点”清零已解决项    |
| 4. 状态变更记录     | 记录状态创建/更新时间、操作人（或触发来源）、变更核心原因                 | 仅记录“创建时间”“触发来源（首轮执行）”             | 需记录“更新时间”“变更项（如‘待办新增XX’）”“变更原因（如‘用户反馈要求’）” |


## 五、质量校验标准
1. **信息完整性**：基础标识无缺失、执行核心状态无模糊表述、待办清单无“空项”或“模糊项”；
2. **逻辑连贯性**：状态变更有明确因果（如“待办新增”需对应“用户反馈”或“工具结果”），进度阶段与动作完成度匹配；
3. **时效性**：更新后的状态需在本轮执行结束后10分钟内完成，确保下一轮执行前状态已同步；
4. **可指导性**：下一轮执行人员仅通过“当前核心状态”和“状态明细”，即可明确“要做什么”“需要什么资源”“要解决什么问题”。


## 六、示例（参考）
### 示例1：场景1（任务初始启动，从第一轮执行信息提取状态）
#### 第一轮执行原始信息
2024-10-21 09:30，用户启动“XX产品历史故障检索”任务，要求“检索2024年7-9月XX产品的故障记录，调用‘故障数据库检索工具’，关键词‘XX产品+故障+2024Q3’”；工具返回2条结果（结果1：2024-08-10硬件故障，结果2：2024-09-05软件BUG）；用户暂未反馈，下一轮需先整理结果再同步。

#### 初始状态提取输出
1. 任务基础标识：任务ID-T2024102101（关联事件ID-T2024102101）、任务名称-XX产品2024Q3故障检索、领域-产品故障分析、启动时间-2024-10-21 09:30、核心目标-检索2024年7-9月XX产品故障记录并整理反馈；  
2. 当前核心状态：进度阶段-启动中、当前已完成动作-调用“故障数据库检索工具”（关键词“XX产品+故障+2024Q3”，返回2条结果）、下一轮待执行动作-整理2条故障结果、进度占比-30%（首轮检索完成，待整理反馈）；  
3. 状态明细：  
   - 资源与依赖：已用资源-“故障数据库检索工具”（返回2条结果）、待补资源-无、关联依赖-无；  
   - 卡点与待办：卡点-无潜在卡点、待办清单（高优先级：整理2条故障结果并标注关键信息）；  
   - 用户交互关联：最新反馈-无、反馈落地-无；  
4. 状态变更记录：创建时间-2024-10-21 09:40、触发来源-任务第一轮执行、变更原因-初始状态搭建。


### 示例2：场景2（已有初始状态，基于第二轮执行更新状态）
#### 第二轮执行原始信息
2024-10-21 10:10，完成故障结果整理（标注结果1为“高频故障”、结果2为“偶发BUG”）；同步用户后，用户反馈“需补充检索2024年6月的故障记录，优先处理高频故障分析”；调用工具补充检索“XX产品+故障+2024-06”，工具返回“无匹配结果”（卡点：6月无故障记录）。

#### 状态更新输出
1. 任务基础标识：任务ID-T2024102101、任务名称-XX产品2024Q3故障检索、领域-产品故障分析、启动时间-2024-10-21 09:30、核心目标-检索2024年6-9月XX产品故障记录并整理反馈（目标更新：新增6月检索范围）；  
2. 当前核心状态：进度阶段-执行中（阶段变更原因：完成首轮结果整理，新增6月检索需求）、当前已完成动作-整理2条故障结果、同步用户反馈、补充检索6月故障（无结果）、下一轮待执行动作-分析高频故障（结果1）并同步“6月无故障”结论、进度占比-60%（检索+整理完成，待分析反馈）；  
3. 状态明细：  
   - 资源与依赖：已用资源-“故障数据库检索工具”（2次调用，首轮2条结果、补充检索无结果）、待补资源-无、关联依赖-无；  
   - 卡点与待办：卡点-补充检索6月故障无结果（影响：无需进一步检索6月，需同步结论）、待办清单（高优先级：分析结果1高频故障；中优先级：同步“6月无故障”结论给用户）；  
   - 用户交互关联：最新反馈-要求补充检索6月故障、优先分析高频故障、反馈落地-目标新增6月范围，待办新增“高频故障分析”；  
4. 状态变更记录：更新时间-2024-10-21 10:20、触发来源-任务第二轮执行、变更原因-完成结果整理+用户新增需求+补充检索无结果。